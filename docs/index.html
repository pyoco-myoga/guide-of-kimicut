<!doctype html>
<html lang="ja">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous">
        </script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.2/font/bootstrap-icons.css"
        integrity="sha384-b6lVK+yci+bfDmaY1u0zE8YYJt0TZxLEAFyYSLHId4xoVvsrQu3INevFKo+Xir8e" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"
        integrity="sha256-oP6HI9z1XaZNBrJURtCoUT5SUnxFr8s3BzRl+cbzUq8=" crossorigin="anonymous"></script>
    <script>
        async function digestMessage(message) {
            const encoder = new TextEncoder();
            const data = encoder.encode(message);
            const hashBuffer = crypto.subtle.digest("SHA-256", data);
            const hashArray = Array.from(new Uint8Array(hashBuffer));                     // バッファーをバイト列に変換する
            const hashHex = hashArray.map(b => b.toString(16).padStart(2, "0")).join(""); // バイト列を16進文字列に変換する
            return hashHex;
        }
        function checkInputNumber(e) {
            let k = e.keyCode;
            let str = String.fromCharCode(k);
            if (!(str.match(/[0-9]/) || (37 <= k && k <= 40) || k === 8 || k === 46)) {
                return false;
            }
        }
        $(document).on("keydown", "#number1", checkInputNumber);
        $(document).on("keydown", "#number2", checkInputNumber);
        $(document).on("keydown", "#month", checkInputNumber);
        $(document).on("keydown", "#date", checkInputNumber);

        $(document).on("click", "#answer", async () => {
            const n = $("#number1").val() * $("#number2").val() * $("#month").val() * $("#date").val();

            console.log(n);
            const hash = await digestMessage(n);

            console.log(hash.toString());
            const url = `https://youtu.be/${n}zhjwTQGo`;
            // window.location.href = url;
        });
    </script>
    <title>センシティブ切り抜きへのみちしるべのページ</title>
</head>

<body>
    <nav class="navbar navbar-light bg-light">
        <div class="container-fluid">
            <span class="navbar-brand mb-0 h1">センシティブ切り抜きへのみちしるべのページ</span>
        </div>
    </nav>
    <div class="table-responsive">
        <table class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th scope="row" class="w-25">問題</th>
                    <td>数字(半角数字で入力しないと上手くYouTubeに飛べません)</td>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <th>動画内の数字①</th>
                    <td><input type="number" id="number1" min="0" max="1000"></td>
                </tr>
                <tr>
                    <th>動画内の数字②</th>
                    <td><input type="number" id="number2" min="0" max="1000"></td>
                </tr>
                <tr>
                    <th>きみかの誕生月(1-12)</th>
                    <td><input type="number" id="month" min="1" max="12"></td>
                </tr>
                <tr>
                    <th>きみかの誕生日(1-31)</th>
                    <td><input type="number" id="date" min="1" max="31"></td>
                </tr>
            </tbody>
        </table>
    </div>
    <button id="answer">答える</button>
</body>

</html>
